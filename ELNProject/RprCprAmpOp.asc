Version 4
SHEET 1 1572 816
WIRE -80 -48 -128 -48
WIRE 48 -48 0 -48
WIRE 592 -48 560 -48
WIRE 720 -48 672 -48
WIRE -464 48 -528 48
WIRE -368 48 -400 48
WIRE -272 48 -368 48
WIRE -128 48 -128 -48
WIRE -128 48 -192 48
WIRE -64 48 -128 48
WIRE -816 64 -816 32
WIRE -816 64 -880 64
WIRE 48 64 48 -48
WIRE 48 64 0 64
WIRE 112 64 48 64
WIRE 240 64 192 64
WIRE 368 64 240 64
WIRE 432 64 368 64
WIRE 560 64 560 -48
WIRE 560 64 512 64
WIRE 608 64 560 64
WIRE -816 80 -816 64
WIRE -64 80 -128 80
WIRE 240 80 240 64
WIRE 720 80 720 -48
WIRE 720 80 672 80
WIRE 816 80 720 80
WIRE -528 96 -528 48
WIRE 368 96 368 64
WIRE 608 96 560 96
WIRE -368 176 -368 128
WIRE -128 208 -128 80
WIRE 240 208 240 160
WIRE 368 208 368 160
WIRE 560 208 560 96
FLAG 368 208 0
FLAG -528 176 0
FLAG 240 208 0
FLAG -880 64 0
FLAG -816 -48 Vcc
FLAG -816 160 Vee
FLAG -32 32 Vcc
FLAG 640 48 Vcc
FLAG -32 96 Vee
FLAG 640 112 Vee
FLAG 816 80 Vout
FLAG 560 208 0
FLAG -128 208 0
FLAG -368 176 0
SYMBOL voltage -528 80 R0
WINDOW 3 -29 218 Left 2
WINDOW 123 -113 200 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE({-Vref} {Vbatt-Vref} 0 0.1u 0.1u {1/(freq*2)} {1/freq})
SYMATTR InstName V1
SYMBOL res -176 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 500k
SYMBOL cap 352 96 R0
SYMATTR InstName Cpr
SYMATTR Value {Cpr}
SYMBOL res 224 64 R0
SYMATTR InstName Rpr
SYMATTR Value {Rpr}
SYMBOL voltage -816 -64 R0
WINDOW 3 53 43 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value {Vbatt-Vref}
SYMATTR InstName V2
SYMBOL voltage -816 64 R0
SYMATTR InstName V3
SYMATTR Value {Vref}
SYMBOL Opamps\\UniversalOpamp2 -32 64 R0
SYMATTR InstName U1
SYMBOL cap -400 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 20n
SYMBOL res 208 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL Opamps\\UniversalOpamp2 640 80 R0
SYMATTR InstName U2
SYMBOL res 688 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 200k
SYMBOL res 16 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res 528 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 200k
SYMBOL res -384 32 R0
SYMATTR InstName R2
SYMATTR Value 500k
TEXT -528 -256 Left 2 !.param freq=2k Vbatt=3 Vref=1.5
TEXT -528 -128 Left 2 !.tran 100m
TEXT -528 -192 Left 2 !.param Rpr table(x,1,1027128,2,26562,3,10087,4,6624,5,776)
TEXT -528 -224 Left 2 !.step param x list 1 2 3 4 5
TEXT -528 -160 Left 2 !.param Cpr table(x,1,6.25e-11,2,2.46e-9,3,4.85e-9,4,8.78e-9,5,5.92e-8)
